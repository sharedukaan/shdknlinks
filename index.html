<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ShoeDukaan | Premium Footwear Catalog</title>
<meta name="description" content="Discover the best shoes & accessories â€“ all in one place. Shop smart with our mobile-first catalog and curated product grid.">
<meta name="keywords" content="premium shoes, footwear catalog, mobile-first grid, Shoe Dukaan, vertical product images, curated shoes, online shoe store">
<meta name="author" content="ShareDukaan">
<link rel="canonical" href="https://shdkn.carrd.co">
<meta name="robots" content="index, follow">
<link rel="icon" href="shdkn_fav_p.png" type="image/png">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "ShareDukaan",
  "url": "https://shdkn.carrd.co"
}
</script>
<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Barlow:wght@500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Assistant:wght@400&display=swap" rel="stylesheet">

<style>
:root {
  --max-width: 1440px;
  --side-padding: 18px;
}

body {
  overflow-x: hidden;
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', sans-serif;
  background: #1c1c1c;
  scroll-behavior: smooth;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.layout-container {
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 0 var(--side-padding);
  box-sizing: border-box;
}

.wrapper.grid-wrapper {
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 0 var(--side-padding);
}

/* Header */
.top-banner {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  background-color: #333;
  color: #fff;
  padding: 12px var(--side-padding);
  position: relative;
}

.logo {
  width: 75px;
  height: auto;
  aspect-ratio: 1 / 1;
  object-fit: contain;
}

.header-right {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  text-align: center;
  flex: 1;
}

.tagline {
  font-family: 'Assistant', sans-serif;
  font-size: 12px;
  font-weight: 400;
  margin-bottom: 4px;
}

/* Desktop override */
@media (min-width: 769px) {
  .tagline {
    white-space: normal;
    max-width: 320px;
    line-height: 1.4;
  }
}

.telegram-link {
  font-family: 'Assistant', sans-serif;
  font-size: 13px;
  color: #ffcc00;
  text-decoration: none;
  font-weight: 500;
}

.telegram-link:hover,
.telegram-link:focus {
  transition: background-color 0.3s ease;
  color: inherit;
}

/* Search Bar */
.search-bar {
  padding: 8px 0;
  text-align: center;
  width: 100%;
  background-color: #1c1c1c;
}

#searchInput {
  width: 90%;
  max-width: 400px;
  padding: 10px 14px;
  font-size: 12px;
  border-radius: 4px;
  border: 1px solid #ccc;
  background-color: #fff;
  color: #000;
}

/* Grid */
.grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 5px;
  padding: 8px 0;
  width: 100%;
  background-color: #1c1c1c;
}

@media (min-width: 1024px) {
  .grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 768px) {
  .top-banner {
    padding: 12px 16px;
  }

  .header-right {
    align-items: flex-start;
    text-align: right;
    width: 100%;
  }

  .telegram-link {
    display: block;
    margin-left: auto;
    margin-right: 0;
    text-align: right;
  }

  .telegram-link:hover,
  .telegram-link:focus {
    transition: background-color 0.3s ease;
    color: inherit;
  }

  .tagline {
    display: block;
    margin-left: auto;
    margin-right: 0;
    text-align: right;
  }

  .logo {
    height: 100px;
    margin-bottom: 8px;
  }
}

/* Card */
.card {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  padding: 6px;
  width: 100%;
  max-width: 420px;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
  box-sizing: border-box;
  aspect-ratio: 3 / 5;
  overflow: hidden;
  opacity: 0;
  transform: translateY(20px);
}

/* Carousel inside Card */
.card .carousel {
  position: relative;
  width: 100%;
  aspect-ratio: 3 / 5;
  overflow: hidden;
  border-radius: 8px;
}

.card .carousel img.active:hover {
  filter: brightness(1.08);
  transition: filter 0.3s ease;
}

.product-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  border-radius: 8px;
}

.card.visible {
  animation: fadeInUp 0.6s ease forwards;
}

.title-text {
  font-family: 'Inter', sans-serif;
  font-weight: 300;
  font-size: 0.95em;
  color: #BABABA;
  margin-top: 15px;
  line-height: 1.1;
  text-align: center;
  max-width: 90%;
  margin: 0 auto;
}

.card:hover {
  transform: scale(1.03);
  box-shadow: 0 10px 24px rgba(0, 0, 0, 0.16);
}

.card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 1px;
  display: block;
}

.action-button-text {
  font-family: 'Barlow', sans-serif;
  font-weight: 500;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

/* Carousel */
.carousel {
  position: relative;
  overflow: hidden;
}

.carousel img {
  position: absolute;
  top: 0;
  left: 100%;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.6s ease, opacity 0.6s ease;
  transform: translateX(100%);
  opacity: 0;
  z-index: 0;
}

.carousel img.active {
  transform: translateX(0%);
  left: 0;
  opacity: 1;
  z-index: 1;
}

.carousel img.active:hover {
  transform: scale(1.03);
  transition: transform 0.3s ease;
}

/* Navigation Bar */
.nav-bar {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 6px;
  padding: 6px 0;
  background-color: rgba(30, 30, 30, 0.85);
  backdrop-filter: blur(8px);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  border-top: 1px solid #444;
  border-bottom: 1px solid #444;
}

/* Nav List */
.nav-list {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
  list-style: none;
  margin: 0;
  padding: 0;
}

/* Nav Item */
.nav-list li {
  display: flex;
  align-items: center;
}

/* Nav Button with Image + Text */
.nav-btn {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  width: 40px;
  height: 40px;
  text-decoration: none;
  font-family: 'Assistant', sans-serif;
  font-size: 12px;
  font-weight: 400;
  color: #BABABA;
  text-transform: uppercase;
  overflow: hidden;
  position: relative;
}

/* PNG Icon */
.nav-btn img {
  width: 40px;
  height: 40px;
  transition: transform 0.3s ease;
}

/* Text Label (hidden by default) */
.nav-text {
  position: absolute;
  bottom: 0;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
  font-size: 10px;
  color: #fff;
  text-align: center;
  width: 100%;
}

/* Hover Behavior */
.nav-btn:hover img {
  transform: scale(0.7);
  transform-origin: top center;
}

.nav-btn:hover .nav-text {
  opacity: 1;
}

/* Optional Separator */
.nav-separator {
  color: #555;
  font-size: 14px;
  user-select: none;
}

.nav-btn.active img {
  transform: scale(0.7);
  transform-origin: top center;
}

.nav-btn.active .nav-text {
  opacity: 1;
  color: #fff;
}

/* Back to Top */
#backToTop {
  position: fixed;
  bottom: 24px;
  right: 24px;
  z-index: 100;
  background-color: #ffcc00;
  color: #000;
  border: none;
  border-radius: 20px;
  padding: 10px 18px;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  display: none;
  transition: background-color 0.3s ease, transform 0.3s ease;
}

#backToTop:hover {
  background-color: #ffd633;
  transform: scale(1.05);
}

/* Footer */
.footer-banner {
  width: 100%;
  background-color: #333;
  color: #BDB9B9;
  padding: 4px 0;
  border-top: 1px solid #3A3A3A;
  opacity: 0.85;
}

.footer-content {
  text-align: center;
  font-family: 'Inter', sans-serif;
  font-weight: 300;
  font-size: 11px;
  line-height: 1.2;
}
.footer-tagline {
  font-weight: 500;
  margin-bottom: 4px;
}

.footer-branding {
  font-size: 12px;
  margin-bottom: 4px;
}

.footer-disclaimer {
  font-size: 12px;
  opacity: 0.85;
}
.buy-divider {
  width: 90%;
  height: 1px;
  background-color: #BDB9B9;
  margin: 20px 0;
  border: none;
  opacity: 0.5;
}
.spacer {
  height: 20px;
}

.buy-button-wrapper {
  display: flex;
  gap: 10px;
  width: 100%;
  margin-left: -6px;
  box-sizing: border-box;
}

.buy-button,
.share-button {
  margin-top: 5px;
  padding: 8px 18px 8px 0;
  background-color: rgba(30, 30, 30, 0.85);
  color: #BABABA;
  text-decoration: none;
  border-radius: 2px;
  transition: background-color 0.3s ease, opacity 0.3s ease;
  align-self: flex-start;
  border: none;
  cursor: pointer;
  font-family: 'Barlow', sans-serif;
  font-weight: 500;
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.buy-button:hover,
.share-button:hover {
  color: #005fa3;
  background-color: #3B3B3B;
  opacity: 0.85;
}

/* Error message */
.error-message {
  color: #ff6b6b;
  text-align: center;
  padding: 20px;
  font-family: 'Inter', sans-serif;
}

/* Loading animation */
.loading-spinner {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255,255,255,.3);
  border-radius: 50%;
  border-top-color: #fff;
  animation: spin 1s ease-in-out infinite;
  margin-right: 10px;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
</head>
<body>
<div class="wrapper grid-wrapper">
  <!-- Header -->
  <header class="top-banner layout-container">
    <div class="header-left">
      <img src="https://i.imgur.com/hp0QbkV.jpeg" alt="ShareDukaan Logo" class="logo">
    </div>
    <div class="header-right">
      <p class="tagline">Discover The Best Shoes & Accessories â€“ All in One Place | Shop Smart!!</p>
      <a href="https://t.me/sharedukaan" class="telegram-link">For daily updates ðŸ‘‰ Telegram</a>
    </div>
  </header>

  <!-- Navigation -->
  <nav class="nav-bar layout-container" role="navigation" aria-label="Main site navigation">
    <ul class="nav-list">
      <li>
        <a href="index.html" class="nav-btn">
          <img src="assets/Home_P.png" alt="Explore" width="40" height="40" />
          <span class="nav-text">Explore</span>
        </a>
      </li>

      <li><span class="nav-separator">|</span></li>
      <li>
        <a href="forhim.html" class="nav-btn">
          <img src="assets/Men_P.png" alt="For Him" width="40" height="40" />
          <span class="nav-text">For Him</span>
        </a>
      </li>

      <li><span class="nav-separator">|</span></li>
      <li>
        <a href="forher.html" class="nav-btn">
          <img src="assets/Women_P.png" alt="For Her" width="40" height="40" />
          <span class="nav-text">For Her</span>
        </a>
      </li>

      <li><span class="nav-separator">|</span></li>
      <li><a href="https://shoedukaan.blogspot.com" class="nav-btn">Blog >></a></li>
    </ul>
  </nav>
  
  <!-- Search Bar -->
  <div class="search-bar layout-container">
    <input type="text" id="searchInput" placeholder="Search for products..." aria-label="Search products">
  </div>

  <!-- Product Grid -->
  <main id="productGrid" class="grid layout-container" aria-label="Product catalog">
    <div class="error-message" id="loadingMessage">Loading products...</div>
  </main>
</div>

<!-- Back to Top Button -->
<button id="backToTop" title="Back to Top">Top</button>

<!-- Footer -->
<footer class="footer-banner">
  <div class="layout-container">
    <div class="footer-content">
      <p class="footer-tagline">Inspired by Google Keep's brilliant simplicity</p>
      <p class="footer-branding">Â© 2025 ShareDukaan. All rights reserved.</p>
      <p class="footer-disclaimer">
        Disclaimer: ShareDukaan is a participant in the Amazon Associates Program. We may earn a small commission when you purchase through affiliate links, at no extra cost to you. Product prices and availability are subject to change. The actual product may differ slightly from the images shown above.
      </p>
    </div>
  </div>
</footer>

<!-- JavaScript -->
<script>
  // Utility function to escape quotes
  function escapeQuotes(str) {
    return String(str).replace(/"/g, '&quot;');
  }

  // Your existing constants and variables
  const colors = [
      "#3A3647", "#1C262E", "#692B17",
      "#0C625D", "#5A6361", "#4B455E", "#596C39", "#396C5D", "#6C394F", "#284255",
  ];

  let allProducts = [];
  let filteredProducts = [];
  let currentIndex = 0;
  const batchSize = 12;

  // Determine current page category
  function getCurrentCategory() {
      const path = window.location.pathname;
      const urlParams = new URLSearchParams(window.location.search);
      const categoryParam = urlParams.get('category');
      
      if (categoryParam) return categoryParam;
      if (path.includes('forhim.html')) return 'for-him';
      if (path.includes('forher.html')) return 'for-her';
      return 'links';
  }

  // Share product function
  async function shareProduct(title, image, buyUrl, permanentId) {
      console.log('shareProduct called with:', title, permanentId);
      
      // Get current category for the source parameter
      const currentCategory = getCurrentCategory();
      
      // Create the product page URL
      const productPageUrl = `${window.location.origin}/product.html?permanentId=${permanentId}&source=${currentCategory}`;
      
      // Create share data
      const shareData = {
          title: title,
          text: `Check out ${title} on ShoeDukaan!`,
          url: productPageUrl
      };
      
      console.log('Sharing product:', shareData);
      
      // Try to use native share dialog
      if (navigator.share) {
          try {
              await navigator.share(shareData);
              console.log('Product shared successfully:', title);
          } catch (error) {
              if (error.name !== 'AbortError') {
                  console.error('Error sharing:', error);
                  // Fallback to copy method
                  copyToClipboard(productPageUrl, title);
              }
          }
      } else {
          // Fallback for browsers that don't support Web Share API
          copyToClipboard(productPageUrl, title);
      }
  }

  // Fallback function to copy to clipboard
  function copyToClipboard(text, productTitle) {
      navigator.clipboard.writeText(text).then(() => {
          alert(`Link for "${productTitle}" copied to clipboard!`);
      }).catch(err => {
          console.error('Could not copy text: ', err);
          prompt('Copy this URL to share:', text);
      });
  }

  // Load products from all categories for search functionality
  async function loadAllProducts() {
      try {
          const sheetID = "1z06jsVC54KkbyH_X3oGwmChEPyP1jrMl625LV5VP7Uw";
          const categories = ['links', 'for-him', 'for-her'];
          
          document.getElementById('loadingMessage').innerHTML = '<span class="loading-spinner"></span> Loading products from all categories...';
          
          // Load data from all categories
          const allData = [];
          for (const category of categories) {
              const url = `https://opensheet.elk.sh/${sheetID}/${category}`;
              const res = await fetch(url);
              if (!res.ok) {
                  console.error(`Failed to load ${category} category`);
                  continue;
              }
              
              const data = await res.json();
              // Add category info to each product
              const categoryData = data.map(item => ({...item, category}));
              allData.push(...categoryData);
          }
          
          // Process products
          allProducts = allData
              .filter(item => item.title && item.img && item.link)
              .sort((a, b) => {
                  if (a.shuffleID && b.shuffleID) {
                      return Number(a.shuffleID) - Number(b.shuffleID);
                  }
                  return a.title.localeCompare(b.title);
              });
          
          if (allProducts.length === 0) {
              document.getElementById('loadingMessage').textContent = 'No products found.';
              return;
          }
          
          // Filter by current category
          const currentCategory = getCurrentCategory();
          if (currentCategory && currentCategory !== 'all') {
              filteredProducts = allProducts.filter(product => product.category === currentCategory);
          } else {
              filteredProducts = allProducts;
          }
          
          document.getElementById('loadingMessage').style.display = 'none';
          renderNextBatch();
      } catch (err) {
          console.error("Failed to load products:", err);
          document.getElementById('loadingMessage').textContent = 'Error loading products. Please check your connection.';
      }
  }

  // Modified generateCardHTML function with data attributes
  function generateCardHTML(item, index) {
      const imageArray = item.img.split(',');
      const carouselHTML = imageArray.map((url, i) =>
          `<img src="${url.trim()}" class="${i === 0 ? 'active' : ''}" loading="lazy" alt="${item.title}" />`
      ).join('');

      // Clean the values for use in JavaScript
      const cleanTitle = escapeQuotes(item.title);
      const firstImage = escapeQuotes(imageArray[0].trim());
      const buyUrl = escapeQuotes(item.link);
      const permanentId = escapeQuotes(item.permanentId || index);
      
      return `
          <div class="carousel" data-seed="${item.shuffleID || index}">
              ${carouselHTML}
          </div>
          <div class="spacer"></div>
          <h3 class="title-text">${item.title.replace(/\n/g, '<br>')}</h3>
          <div class="buy-divider"></div>
          <div class="buy-button-wrapper">
              <a class="buy-button action-button-text" href="${item.link}" target="_blank" aria-label="Buy ${item.title}">
                  ðŸ‘‰ðŸ‘‰ Buy Now
              </a>
              <button class="share-button action-button-text" 
                      data-title="${cleanTitle}" 
                      data-image="${firstImage}" 
                      data-url="${buyUrl}" 
                      data-id="${permanentId}" 
                      aria-label="Share ${item.title}">
                  ðŸ“¤ Share
              </button>
          </div>
      `;
  }

  // Your existing renderNextBatch function
  function renderNextBatch() {
      const grid = document.getElementById("productGrid");
      if (!grid || filteredProducts.length === 0) return;

      const nextItems = filteredProducts.slice(currentIndex, currentIndex + batchSize);

      nextItems.forEach((item, i) => {
          const card = document.createElement("article");
          card.className = "card";
          card.setAttribute("role", "article");
          card.setAttribute("aria-label", item.title);
          card.style.backgroundColor = colors[(currentIndex + i) % colors.length];
          card.style.transitionDelay = `${i * 100}ms`;
          card.innerHTML = generateCardHTML(item, i);

          grid.appendChild(card);
          observer.observe(card);
      });

      activateCarousels(".carousel");
      currentIndex += batchSize;
  }

  // Your existing activateCarousels function
  function activateCarousels(selector = ".carousel") {
      document.querySelectorAll(selector).forEach((carousel, index) => {
          if (carousel.dataset.activated === "true") return;
          carousel.dataset.activated = "true";

          const images = carousel.querySelectorAll("img");
          if (images.length <= 1) return;

          let current = 0;

          function shuffle() {
              images.forEach((img, i) => img.classList.toggle("active", i === current));
              current = (current + 1) % images.length;

              const seed = Number(carousel.dataset.seed) || index;
              const nextDelay = 2000 + (seed % 3000);
              setTimeout(shuffle, nextDelay);
          }

          const initialDelay = Math.floor(Math.random() * 3000);
          setTimeout(shuffle, initialDelay);
      });
  }

  // Your existing Intersection Observer
  const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
          entry.target.classList.toggle('visible', entry.isIntersecting);
      });
  }, {
      threshold: 0.1
  });

  // Search function that works across all pages
  function performSearch(query) {
      const grid = document.getElementById("productGrid");
      if (!grid) return;

      grid.innerHTML = "";
      currentIndex = 0;

      if (query === "") {
          // If no query, show products from current category
          const currentCategory = getCurrentCategory();
          if (currentCategory && currentCategory !== 'all') {
              filteredProducts = allProducts.filter(product => product.category === currentCategory);
          } else {
              filteredProducts = allProducts;
          }
      } else {
          // If there's a query, search across all products
          filteredProducts = allProducts.filter(item =>
              item.title.toLowerCase().includes(query)
          );
      }
      
      if (filteredProducts.length === 0) {
          grid.innerHTML = '<div class="error-message">No products match your search.</div>';
      } else {
          filteredProducts.slice(0, batchSize).forEach((item, i) => {
              const card = document.createElement("article");
              card.className = "card";
              card.setAttribute("role", "article");
              card.setAttribute("aria-label", item.title);
              card.style.backgroundColor = colors[i % colors.length];
              card.style.transitionDelay = `${i * 100}ms`;
              card.innerHTML = generateCardHTML(item, i);

              grid.appendChild(card);
              observer.observe(card);
          });

          activateCarousels(".carousel");
      }
  }

  // Event delegation for share buttons
  document.addEventListener('click', function(e) {
      if (e.target.classList.contains('share-button')) {
          const title = e.target.dataset.title;
          const image = e.target.dataset.image;
          const buyUrl = e.target.dataset.url;
          const permanentId = e.target.dataset.id;
          
          console.log('Share button clicked:', title);
          shareProduct(title, image, buyUrl, permanentId);
      }
  });

  // Initialize the page
  window.addEventListener("DOMContentLoaded", function() {
      // Load products from all categories
      loadAllProducts();
      
      // Set up search functionality
      const searchInput = document.getElementById("searchInput");
      if (searchInput) {
          // Check if there's a search query in the URL
          const urlParams = new URLSearchParams(window.location.search);
          const searchQuery = urlParams.get('search');
          if (searchQuery) {
              searchInput.value = searchQuery;
              // Perform search after products are loaded
              setTimeout(() => performSearch(searchQuery), 1000);
          }
          
          searchInput.addEventListener("input", function() {
              const query = this.value.toLowerCase();
              performSearch(query);
              
              // Update URL with search query
              const url = new URL(window.location);
              if (query) {
                  url.searchParams.set('search', query);
              } else {
                  url.searchParams.delete('search');
              }
              window.history.replaceState({}, '', url);
          });
      }
      
      // Set up scroll event for infinite scrolling
      window.addEventListener("scroll", () => {
          const scrollY = window.scrollY;
          const viewportHeight = window.innerHeight;
          const fullHeight = document.body.offsetHeight;

          if (scrollY + viewportHeight >= fullHeight - 100 && currentIndex < filteredProducts.length) {
              renderNextBatch();
          }

          const backToTopBtn = document.getElementById("backToTop");
          if (backToTopBtn) {
              backToTopBtn.style.display = scrollY > 300 ? "block" : "none";
          }
      });

      // Set up back to top button
      const backToTopBtn = document.getElementById("backToTop");
      if (backToTopBtn) {
          backToTopBtn.addEventListener("click", () => {
              window.scrollTo({ top: 0, behavior: "smooth" });
          });
      }
      
      // Set active navigation link
      document.querySelectorAll('.nav-btn').forEach(link => {
          if (link.href === window.location.href) {
              link.classList.add('active');
          }
      });
  });
</script>
</body>
</html>
