      allProducts = data.filter(item => item.title && item.img && item.link);
      renderNextBatch();
    }

    function renderNextBatch() {
      const grid = document.getElementById("productGrid");
      const nextItems = allProducts.slice(currentIndex, currentIndex + batchSize);

      const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
    } else {
      entry.target.classList.remove('visible');
    }
  });
}, {
  threshold: 0.1
});
      nextItems.forEach((item, i) => {
        const card = document.createElement("div");
        card.className = "card";
        card.style.backgroundColor = colors[(currentIndex + i) % colors.length];
        card.style.transitionDelay = `${i * 100}ms`; // âœ… Use this instead
        card.innerHTML = `
          <img src="${item.img}" alt="${item.title}" loading="lazy" />
          <p class="card-text">${item.desc}</p>
          <a class="buy-button action-button-text" href="${item.link}" target="_blank">ðŸ”— Link</a>
        `;
        grid.appendChild(card);
        observer.observe(card);
      });

      currentIndex += batchSize;
    }
const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');
    } else {
      entry.target.classList.remove('visible'); // ðŸ‘ˆ Re-trigger animation
    }
  });
}, {
  threshold: 0.1
});
    window.addEventListener("scroll", () => {
      const scrollY = window.scrollY;
      const viewportHeight = window.innerHeight;
      const fullHeight = document.body.offsetHeight;

      if (scrollY + viewportHeight >= fullHeight - 100) {
        if (currentIndex < allProducts.length) {
          renderNextBatch();
        }
      }

      // Show/hide Back to Top button
      const backToTopBtn = document.getElementById("backToTop");
      backToTopBtn.style.display = scrollY > 300 ? "block" : "none";
    });

    document.getElementById("backToTop").addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    document.getElementById("searchInput").addEventListener("input", function () {
      const query = this.value.toLowerCase();
      const cards = document.querySelectorAll(".card");

      cards.forEach(card => {
        const title = card.querySelector(".carrd-text").textContent.toLowerCase();
        card.style.display = title.includes(query) ? "flex" : "none";
      });
    });

    loadProducts();
  </script>

</body>
        </html>
         
