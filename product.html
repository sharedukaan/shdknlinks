// In product.html
const urlParams = new URLSearchParams(window.location.search);
const permanentId = urlParams.get('permanentId');
const sourceParam = urlParams.get('source');

// Determine which sheet to use based on permanentId prefix
function determineSourceFromId(permanentId) {
    if (permanentId.startsWith('L')) return 'links';
    if (permanentId.startsWith('M')) return 'for-him';
    if (permanentId.startsWith('W')) return 'for-her';
    return sourceParam || 'links'; // fallback
}

const sourceTab = determineSourceFromId(permanentId);

// Then fetch the specific product from the appropriate sheet tab
async function loadProduct() {
    try {
        const url = `https://opensheet.elk.sh/YOUR_SHEET_ID/${sourceTab}`;
        const response = await fetch(url);
        const data = await response.json();
        
        // Find product by permanentId
        const product = data.find(item => item.permanentId === permanentId);
        
        if (product) {
            // Display the product
            renderProduct(product);
        } else {
            document.getElementById('product-content').innerHTML = '<p>Product not found.</p>';
        }
    } catch (error) {
        console.error('Error loading product:', error);
        document.getElementById('product-content').innerHTML = '<p>Error loading product.</p>';
    }
}
